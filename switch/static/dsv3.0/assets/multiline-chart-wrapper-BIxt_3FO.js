import{S as M,i as k,r as N,g as _,k as f,a as x,j as m}from"./index-C2PWchud.js";import{f as y}from"./transform-C4D8YA0C.js";import{l as v,a as V,f as w,b as q,m as O}from"./linear-B99wrUbv.js";import{u as T}from"./utils-mixin-D5aAiqNi.js";import{l as $}from"./line-yPdCpPKw.js";import{s as b}from"./value-_r9_x9JY.js";import{m as D}from"./mouse-zJOo7xoE.js";import{w as F}from"./datasource-mixin-DMQBE4lo.js";import"./array-UnU61Zeg.js";import"./constant-BhYcI2Bl.js";import"./path-BevWroqt.js";function I(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function R(t,e){return fetch(t,e).then(I)}const z=class extends T(M){static get is(){return"multiline-chart"}static get properties(){return{icon:String,dataName:{type:String,value:""},service:String,title:String,maxlength:Number,pattern:String,q:{type:String,value:""},dropdownValue:Object,rows:{value:[]},params:{type:Object,value:""},columnSize:{type:Array}}}initMultiline(){const t={top:40,right:120,bottom:30,left:40},e=800-t.left-t.right,r=400-t.top-t.bottom,a=v().domain([1910,2010]).range([0,e]),l=v().domain([0,4e7]).range([r,0]),c=$().x(o=>a(o.name)).y(o=>l(o.value)),s=b("svg").append("g").attr("transform","translate("+t.left+","+t.top+")"),d=b("#tooltip"),h=s.append("line"),j=V(a).tickFormat(w(".4")),C=q(l).tickFormat(w(".2s"));s.append("g").call(C),s.append("g").attr("transform","translate(0,"+r+")").call(j),s.append("text").html("State Population Over Time").attr("x",200);let p,g;R("data.json",function(o,n){n[0].data,n[0].cols;var u=n[0].rows;a.domain(u.map(function(i){return i[1]})),l.domain([0,O(u,function(i){return i[0]})]),s.selectAll().data(p).enter().append("path").attr("fill","none").attr("stroke",i=>i.color).attr("stroke-width",2).datum(i=>i.history).attr("d",c),s.selectAll().data(p).enter().append("text").html(i=>i.name).attr("fill",i=>i.color).attr("alignment-baseline","middle").attr("x",e).attr("dx",".5em").attr("y",i=>l(i.currentvalue)),g=s.append("rect").attr("width",e).attr("height",r).attr("opacity",0).on("mousemove",L).on("mouseout",A)});function A(){d&&d.style("display","none"),h&&h.attr("stroke","none")}function L(){const o=Math.floor((a.invert(D(g.node())[0])+5)/10)*10;p.sort((n,u)=>u.history.find(i=>i.name==o).value-n.history.find(i=>i.name==o).value),h.attr("stroke","black").attr("x1",a(o)).attr("x2",a(o)).attr("y1",0).attr("y2",r),d.html(o).style("display","block").style("left",y.pageX+20).style("top",y.pageY-20).selectAll().data(p).enter().append("div").style("color",n=>n.color).html(n=>n.name+": "+n.history.find(u=>u.name==o)).value}}getValue(){const t=this.shadowRoot.querySelector("#input");return this.multilineValue=t.value,this.lineValue}getName(){return this.e.formName.split("=")[0]}validate(){return!(this.e.required&&!this.getValue())}_dataJoined(t){const e=this;return t.filter(function(r,a){return!(a===0||e.cols.length&&e.cols[a].type==="href")}).join(" ")}dscDataName(){return this.dataName}firstUpdated(t){super.firstUpdated(t);const e=this;this.loader.then(r=>{rows.dsc,e.initMultiline(r)})}_computeItemsCount(t){return t.length}_shouldFilter(t){var e=this._computeItemsCount(t);return e>10}_computeItems(t,e){const r=[];for(let c=0;c<t.length;c++){const s=t[c];if(e){var a=e.toLowerCase(),l=s[1].toLowerCase();l.indexOf(a)!==-1&&r.push(s)}else r.push(s)}return r}init(t,e){super.init(t,e);var r=this;r.required=t.min&&t.min>0,r.title=DropdownSelect.toTitleCase(t.name),r.icon=t.icon,r.service=t.service,r.params=r.pl.paramsCopy(),r.dataName=t.defaultValue,r.dropdownValue=Number(t.kind),r.maxlength=t.max,r.loader=this.loadData()}};/**
@license
Copyright (c) 2020 InterIntel Technologies. All rights reserved.

*/const B=k`
option{
    font-size: 18px;
    }
`;class S extends z{static get styles(){return[N(_),B,k`
      :host{
        display: block;
      }
      `]}constructor(){super(),this.rows=[],this.cols=[],this.e=null}static get properties(){return{rows:{type:Array},e:{type:Object},cols:{type:Array}}}updated(e){(e.has("e")||e.has("cols"))&&console.log("Updated properties:",this.cols,this.rows,this.e)}render(){return this.rows===void 0||this.q===void 0?f``:f`
   <div class="column">
 <div class="field" style="margin-top: 10px; margin-bottom: 10px;">
 <label class="form-label">${this.e.name}</label>
   <div class="select is-fullwidth">
  <select id="input" style="text-indent: 20px;padding: 0px; border-radius: 4px;">
    ${this._computeItems(this.rows,this.q).map(e=>f`<option value="${e[0]}">${this._dataJoined(e)}</option>`)}
  </select>
</div>
  </div>
  </div>`}}customElements.define(S.is,S);const J=({element:t,rows:e,cols:r})=>{const a=x.useRef(null);return x.useEffect(()=>{a.current&&t&&(a.current.e!==t&&(a.current.e=t),a.current.rows=e,a.current.cols=r)},[t,e,r]),m.jsx(m.Fragment,{children:t?m.jsx("multiline-chart",{id:"multiline-chart",ref:a}):m.jsx("p",{children:"Loading data..."})})},tt=F(J);export{tt as default};
