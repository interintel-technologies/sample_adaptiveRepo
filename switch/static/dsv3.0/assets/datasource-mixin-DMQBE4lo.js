import{x as z,a as n,j,y as B,D as F,L as Q}from"./index-C2PWchud.js";const V=S=>z(s=>{const g=JSON.stringify(s),[h,i]=n.useState(!1),[w,C]=n.useState(s.service||""),E=()=>{throw new Error('using "withServiceCall" must override "serviceCallParams"')},D=()=>({}),u=async(o,P)=>{console.log("service is ",o),i(!0);try{const c=await s.call(o,P);return c.parseAll(D()),i(!1),c}catch(c){throw i(!1),c}},y=async o=>u(o,E());return j.jsx(S,{...s,httpProps:g,loading:h,callService:y,callServiceParams:u,service:w,setService:C})}),W=S=>V(s=>{const[g,h]=n.useState([]),[i,w]=n.useState([]),[C,E]=n.useState([]),[D,u]=n.useState([]),[y,o]=n.useState([]),[P,c]=n.useState([]),[m,H]=n.useState(1),[d,R]=n.useState(10),[T,_]=n.useState(0),[A,b]=n.useState(0),[I,K]=n.useState(!1),[G,x]=n.useState(!1),[O,f]=n.useState({}),L=async(t="")=>{x(!0);try{const a=await B("DATA SOURCE",J(t),!0),e=new F(a,M());h(e.data),w(e.rows),E(e.cols),u(e.groups),o(e.columns),c(e.commandResponse.response.response.data_source.lines),_(e.totalElements),b(Math.ceil(e.totalElements/d)),K(!(e.rows.length||e.groups.length||e.data.length||e.commandResponse.response.response.data_source.lines)),x(!1)}catch(a){Q.i.error(a)}finally{x(!1)}},J=(t="")=>{const a={...O,data_name:s.element.defaultValue,limit:d,page:m};return t&&(a.search=t),s.element&&s.element.details.params&&s.e.detals.params.forEach(e=>{e in s.params&&(a[e]=s.params[e])}),a},M=()=>({responseType:Symbol.for("LIST")}),N=()=>{f(t=>{if(s.element&&s.element.details&&s.element.details.params){const a=s.element.details.params;return Object.keys(t).filter(r=>a.includes(r)).reduce((r,l)=>(r[l]=t[l],r),{})}return{}}),L()},U=t=>{f(a=>({...a,...t}))},$=(t,a)=>{f(e=>(!(t in e)&&a===void 0||t in e&&a===e[t]||(e={...e,[t]:a}),e))},q=(t,a=!0)=>{f(e=>{const r={...e};for(let l=0;l<t.length;l++){const p=t[l];p in e&&delete r[p]}return r})};return n.useEffect(()=>{L()},[m,d,O,m]),j.jsx(S,{...s,data:g,rows:i,cols:C,groups:D,columns:y,lines:P,page:m,limit:d,setLimit:R,totalElements:T,totalPages:A,empty:I,isDscLoading:G,refresh:N,mergeParams:U,updateParams:$,deleteParamKeys:q,loadData:L,setPage:H})}),Y=W;export{Y as w};
