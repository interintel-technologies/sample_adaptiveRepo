import{i as R,S as I,k as T,r as q,g as z,a as w,j as k}from"./index-C2PWchud.js";import"./paho-mqtt-CBfrIYbz.js";import{u as O}from"./utils-mixin-D5aAiqNi.js";import{h as M}from"./transform-C4D8YA0C.js";import{l as U,m as S,b as L,a as $}from"./linear-B99wrUbv.js";import{b as F}from"./band-BugeWyNR.js";import{o as K}from"./ordinal-CG2fZEFB.js";import{s as v}from"./value-_r9_x9JY.js";import{c as x}from"./constant-BhYcI2Bl.js";import{t as _}from"./defaultLocale-CUWc-s_R.js";import"./fa-icon-COAiXmZs.js";import{C as V}from"./chart-mixin-styles-css-ChS978uy.js";import{w as W}from"./datasource-mixin-DMQBE4lo.js";import"./array-UnU61Zeg.js";import"./lit-html-dRijB2IX.js";function H(e,t){for(var s=new Array(t),r=0;r<t;++r)s[r]=e(r/(t-1));return s}function j(e){for(var t=e.length/6|0,s=new Array(t),r=0;r<t;)s[r]="#"+e.slice(r*6,++r*6);return s}function P(e){return M(e[e.length-1])}var G=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(j);const Y=P(G);var A=Array.prototype.slice;function E(e,t){if((u=e.length)>1)for(var s=1,r,l,o=e[t[0]],u,c=o.length;s<u;++s)for(l=o,o=e[t[s]],r=0;r<c;++r)o[r][1]+=o[r][0]=isNaN(l[r][1])?l[r][0]:l[r][1]}function B(e){for(var t=e.length,s=new Array(t);--t>=0;)s[t]=t;return s}function J(e,t){return e[t]}function Q(){var e=x([]),t=B,s=E,r=J;function l(o){var u=e.apply(this,arguments),c,y=o.length,g=u.length,a=new Array(g),f;for(c=0;c<g;++c){for(var i=u[c],p=a[c]=new Array(y),d=0,m;d<y;++d)p[d]=m=[0,+r(o[d],i,d,o)],m.data=o[d];p.key=i}for(c=0,f=t(a);c<g;++c)a[f[c]].index=c;return s(a,f),a}return l.keys=function(o){return arguments.length?(e=typeof o=="function"?o:x(A.call(o)),l):e},l.value=function(o){return arguments.length?(r=typeof o=="function"?o:x(+o),l):r},l.order=function(o){return arguments.length?(t=o==null?B:typeof o=="function"?o:x(A.call(o)),l):t},l.offset=function(o){return arguments.length?(s=o??E,l):s},l}const X=R`

`,Z=class extends O(I){constructor(){super(),this.e=null}static get properties(){return{e:{type:Object}}}static get is(){return"stacked-bar"}initStackedBarChart(e){console.log(e);const t=e.data;t.forEach(n=>(new Date(n.DATE),n.DATE=new Date(n.DATE)));const s=960,r=500,l=5,o=5,u=40,c=v(this.shadowRoot.querySelector("#chart")).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+u+" -"+u+" "+(s+u*3)+" "+(r+u*3)).style("padding",o).style("margin",l).classed("svg-content",!0),y=["DELIVERED","OFFLINE","SENT","UNDELIVERED","UNKNOWN"],a=Q().keys(y)(t),f=F().range([0,s]),i=U().rangeRound([r,0]);f.domain(t.map(n=>n.DATE)),i.domain([0,S(a,n=>S(n,h=>h[1]))]).rangeRound([r,0]);const p=L().scale(i),d=$().scale(f).tickFormat(_("%b-%d")),m=K().domain(a.map(n=>n.key)).range(H(n=>Y(n*.8+.1),a.length).reverse()).unknown("#ccc");c.append("g").attr("class","axis").attr("transform",`translate(40, ${r})`).call(d),c.append("text").attr("transform",`translate(${s/2},${r-5})`).attr("y","3em").style("text-anchor","middle").style("color","#4a4a4a").text("Dates"),c.append("g").attr("class","axis").attr("transform","translate(40, 0)").call(p),c.append("text").attr("transform","rotate(-90)").attr("x","-250").attr("y","-1em").style("text-anchor","middle").style("color","#4a4a4a").text(y);const b=c.append("g").attr("class","legend").attr("transform","translate("+(s-50)+",20)").selectAll("g").data(a).enter().append("g");b.append("rect").attr("y",(n,h)=>h*30).attr("height",10).attr("width",10).attr("fill",n=>m(n.key)),b.append("text").attr("y",(n,h)=>h*30+9).attr("x",5*3).text(n=>n.key),c.append("text").attr("class","chart-title").attr("y",-40).attr("x",innerHeight/2).text(this.e.name).attr("font-family","arial").attr("font-size",24).style("font-weight","bold").style("font-size","30").style("transform","translate(-229px, 25px)"),v(this.shadowRoot.querySelector("#chart")).append("div").style("opacity",0).attr("class","tooltip").style("background-color","white").style("position","absolute").style("border","solid").style("border-width","2px").style("border-radius","5px").style("padding","5px"),c.append("g").attr("transform","translate(40, 0)").selectAll("g").data(a).enter().append("g").attr("fill",function(n){return m(n.key)}).selectAll("rect").data(function(n){return n}).enter().append("rect").attr("x",function(n){return f(n.data.DATE)}).attr("y",function(n){return i(n[1])}).attr("height",function(n){return i(n[0])-i(n[1])}).attr("width",f.bandwidth())}dscDataName(){return this.e.defaultValue}updated(e){if(e.has("e")){const t=this;if(t.e.kind)try{t.register(t,t.e.kind)}catch(s){console.error(s)}t.initStackedBarChart(this.e)}}init(e,t){super.init(e,t);var s=this;s.loader=this.loadData()}};var D=Object.freeze,tt=Object.defineProperty,et=(e,t)=>D(tt(e,"raw",{value:D(e.slice())})),C;const rt=e=>class extends e{static get styles(){return[V,R`
                :host {
                display: block;
                }
            `]}render(){return T(C||(C=et([`
          <script src="https://d3js.org/d3.v6.min.js"><\/script>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">      
          <div class="chart-container">
            <div id="chart" class="card is-flex content"></div>
          </div>
        `])))}static get properties(){return{icon:Boolean,rounded:Boolean,large:Boolean,size:String,color:String}}constructor(){super(),this.icon=!1,this.rounded=!1,this.large=!1,this.size=32,this.color="#0040bf",this.type=""}firstUpdated(t){super.firstUpdated(t),this.chartSummaryDetails&&this.shadowRoot.querySelector(".card").setAttribute("style","box-shadow: none")}_onAction(t){switch(this.action){case ACTION_SERVICE_CALL:this.pl._dialog(this.e.service,this.params);break;case ACTION_LINK_WINDOW:break;case ACTION_SUBMIT:default:this.pl.submitForm()}}};class N extends rt(Z){static get styles(){return[q(z),X]}}customElements.define(N.is,N);const at=e=>s=>{const r=w.useRef(null),l=a=>a.length===0||!a.trim(),o=a=>{if(!a)return"";a=a.toString(),a=a.toLowerCase().split(" ");let f=[];for(let i=0;i<a.length;i++)f[i]=a[i].charAt(0).toUpperCase()+a.slice(1);return f.join(" ")},u=a=>r.current?r.current.querySelector(a):document.querySelector(a),c=a=>r.current?r.current.querySelectorAll(a):document.querySelectorAll(a),y=(a,f)=>{let i,p,d,m=f/a,b=Math.floor(m*6),n=m*6-b,h=1-n;switch(b%6){case 0:i=1,p=n,d=0;break;case 1:i=h,p=1,d=0;break;case 2:i=0,p=1,d=n;break;case 3:i=0,p=h,d=1;break;case 4:i=n,p=0,d=1;break;case 5:i=1,p=0,d=h;break}return"#"+("00"+Math.round(i*255).toString(16)).slice(-2)+("00"+Math.round(p*255).toString(16)).slice(-2)+("00"+Math.round(d*255).toString(16)).slice(-2)},g=a=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(a);return k.jsx(e,{...s,isEmpty:l,toTitleCase:o,qs:u,qsa:c,randomColorGenerator:y,formatToKenyaShillings:g,ref:r})},nt=at,st=({element:e})=>{const t=w.useRef(null);return w.useEffect(()=>{const s=t.current;s&&e&&(s.e=e)},[e]),k.jsx("div",{children:e?k.jsx("stacked-bar",{id:"stacked-bar",ref:t}):k.jsx("p",{children:"Loading data..."})})},St=nt(W(st));export{St as default};
